import fastify from "fastify";
import pov from "point-of-view";
import fastifyFormbody from "fastify-formbody";
import path from "path";

export const app = fastify({ logger: true });
app.register(fastifyFormbody);

const PORT = 8080;
const HOST = "localhost";

app.register(pov, {
  engine: {
    ejs: require("ejs"),
  },
  root: path.join(__dirname + "/../views"),
});

const start = async () => {
  try {
    await app.listen(PORT, HOST);
    app.log.info(`Server listening on port ${PORT} at ${HOST}`);
  } catch (err) {
    app.log.error(err);
    console.log(err);
    process.exit(1);
  }
};

start();
